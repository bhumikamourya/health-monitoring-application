{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect } from \"react\";\nimport api from \"../utils/api\";\nconst toYMD = d => {\n  const yyyy = d.getFullYear();\n  const mm = String(d.getMonth() + 1).padStart(2, \"0\");\n  const dd = String(d.getDate()).padStart(2, \"0\");\n  return `${yyyy}-${mm}-${dd}`;\n};\n\n// For single value charts (water, sugar, steps, calories, heart rate, oxygen, distance etc.)\nexport const useChartData = (metric, dataKey, days = 7) => {\n  _s();\n  const [data, setData] = useState([]);\n  const [todayTotal, setTodayTotal] = useState(0);\n  const [avg, setAvg] = useState(0);\n  useEffect(() => {\n    const fetchSummary = async () => {\n      try {\n        // endpoint\n        const res = await api.get(`/metrics/${metric}/summary?days=${days}`);\n        const map = new Map(res.data.map(d => [d.date, Number(d[dataKey]) || 0]));\n        const end = new Date();\n        end.setHours(0, 0, 0, 0);\n        const start = new Date(end);\n        start.setDate(end.getDate() - (days - 1));\n        const filled = [];\n        const totals = [];\n        for (let d = new Date(start); d <= end; d.setDate(d.getDate() + 1)) {\n          const key = toYMD(d);\n          const val = Number(map.get(key)) || 0;\n          filled.push({\n            date: key,\n            [dataKey]: val\n          });\n          totals.push(val);\n        }\n        setData(filled);\n        const todayKey = toYMD(end);\n        setTodayTotal(Number(map.get(todayKey)) || 0);\n        const sum = totals.reduce((a, b) => a + b, 0);\n        setAvg(Math.round(sum / totals.length * 10) / 10);\n      } catch (err) {\n        console.error(`Failed to load ${metric} summary`, err);\n      }\n    };\n    fetchSummary();\n  }, [metric, dataKey, days]);\n  return {\n    data,\n    todayTotal,\n    avg\n  };\n};\n_s(useChartData, \"/Iyoxp+zU+WviC77+p6rukXWERo=\");","map":{"version":3,"names":["useState","useEffect","api","toYMD","d","yyyy","getFullYear","mm","String","getMonth","padStart","dd","getDate","useChartData","metric","dataKey","days","_s","data","setData","todayTotal","setTodayTotal","avg","setAvg","fetchSummary","res","get","map","Map","date","Number","end","Date","setHours","start","setDate","filled","totals","key","val","push","todayKey","sum","reduce","a","b","Math","round","length","err","console","error"],"sources":["C:/Users/hp/Desktop/BHUMIIIII/health-tracker/frontend/src/Hook/useChartData.js"],"sourcesContent":["import { useState, useEffect } from \"react\";\r\nimport api from \"../utils/api\";\r\n\r\nconst toYMD = (d) => {\r\n  const yyyy = d.getFullYear();\r\n  const mm = String(d.getMonth() + 1).padStart(2, \"0\");\r\n  const dd = String(d.getDate()).padStart(2, \"0\");\r\n  return `${yyyy}-${mm}-${dd}`;\r\n};\r\n\r\n// For single value charts (water, sugar, steps, calories, heart rate, oxygen, distance etc.)\r\nexport const useChartData = (metric, dataKey, days = 7) => {\r\n  const [data, setData] = useState([]);\r\n  const [todayTotal, setTodayTotal] = useState(0);\r\n  const [avg, setAvg] = useState(0);\r\n\r\n  useEffect(() => {\r\n    const fetchSummary = async () => {\r\n      try {\r\n        // endpoint\r\n        const res = await api.get(`/metrics/${metric}/summary?days=${days}`);\r\n\r\n        const map = new Map(res.data.map((d) => [d.date, Number(d[dataKey]) || 0]));\r\n\r\n        const end = new Date();\r\n        end.setHours(0, 0, 0, 0);\r\n        const start = new Date(end);\r\n        start.setDate(end.getDate() - (days - 1));\r\n\r\n        const filled = [];\r\n        const totals = [];\r\n\r\n        for (let d = new Date(start); d <= end; d.setDate(d.getDate() + 1)) {\r\n          const key = toYMD(d);\r\n          const val = Number(map.get(key)) || 0;\r\n          filled.push({ date: key, [dataKey]: val });\r\n          totals.push(val);\r\n        }\r\n\r\n        setData(filled);\r\n\r\n        const todayKey = toYMD(end);\r\n        setTodayTotal(Number(map.get(todayKey)) || 0);\r\n\r\n        const sum = totals.reduce((a, b) => a + b, 0);\r\n        setAvg(Math.round((sum / totals.length) * 10) / 10);\r\n      } catch (err) {\r\n        console.error(`Failed to load ${metric} summary`, err);\r\n      }\r\n    };\r\n\r\n    fetchSummary();\r\n  }, [metric, dataKey, days]);\r\n\r\n  return { data, todayTotal, avg };\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}